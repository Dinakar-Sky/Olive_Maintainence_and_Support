call DBA.sp_DDL ('drop', 'view', 'Decisioning', 'Active_subscriber_Report');
call DBA.sp_DDL ('create', 'view', 'Decisioning', 'Active_subscriber_Report','select Active_Subscriber_Report_Src.Effective_From_Dt,Active_Subscriber_Report_Src.Effective_To_Dt,Active_Subscriber_Report_Src.Effective_From_Subs_Week,Active_Subscriber_Report_Src.Effective_To_Subs_Week,Active_Subscriber_Report_Src.Account_Number,Active_Subscriber_Report_Src.Account_Type,Active_Subscriber_Report_Src.Account_Sub_Type,Active_Subscriber_Report_Src.Owning_Cust_Account_ID,Active_Subscriber_Report_Src.Subscription_Type,Active_Subscriber_Report_Src.Subscription_Sub_Type,Active_Subscriber_Report_Src.Service_Instance_ID,Active_Subscriber_Report_Src.Subscription_ID,Active_Subscriber_Report_Src.ph_subs_hist_sk,Active_Subscriber_Report_Src.Status_Code,Active_Subscriber_Report_Src.Current_Product_sk,Active_Subscriber_Report_Src.Product_Holding,Active_Subscriber_Report_Src.Country,Active_Subscriber_Report_Src.PH_Subs_Status_Start_Dt,Active_Subscriber_Report_Src.PH_Subs_Status_End_Dt_Dt,Active_Subscriber_Report_Src.PH_Subs_Prev_Status_Code,Active_Subscriber_Report_Src.PH_Subs_Status_Reason,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''DTV'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as DTV_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''DTV'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as DTV_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Broadband'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as BB_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Broadband'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as BB_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Talk'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Talk_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Talk'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Talk_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Line Rental'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as LR_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Line Rental'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as LR_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sports'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Sports_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sports'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Sports_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Movies'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Movies_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Movies'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Movies_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Top Tier'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as TT_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Top Tier'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as TT_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''HD'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as HD_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''HD'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as HD_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Multiscreen'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as MS_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Multiscreen'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as MS_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sky Go Extra'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as SGE_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sky Go Extra'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as SGE_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''Chelsea TV'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Chelsea_TV_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''Chelsea TV'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Chelsea_TV_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''MU TV'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as MUTV_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''MU TV'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as MUTV_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''Liverpool TV'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Liverpool_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''Liverpool TV'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Liverpool_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''Sky Asia'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as SkyAsia_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''A-LA-CARTE'' and Active_Subscriber_Report_Src.product_holding = ''Sky Asia'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as SkyAsia_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sky +'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as SkyPlus_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sky +'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as SkyPlus_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''SKY_BOX_SETS'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as BoxSets_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''SKY_BOX_SETS'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as BoxSets_Active_Subscription,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''SKY_KIDS'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Kids_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''SKY_KIDS'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Kids_Active_Subscription,
cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''ESPN'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as ESPN_Active,
cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''ESPN'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as ESPN_Active_Subscription, cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''SPOTIFY'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as SPOTIFY_Active,cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''SPOTIFY'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as SPOTIFY_Active_Subscription,

cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''ULTIMATE_OD_STREAMING_PRODUCTS'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as Netflix_Active,

cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''ULTIMATE_OD_STREAMING_PRODUCTS'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as Netflix_Active_Subscription,
cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''BBBOOST'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as BBBOOST_Active,
cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''BBBOOST'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as BBBOOST_Active_Subscription,

cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sport Extra'' or Active_Subscriber_Report_Src.subscription_sub_type = ''Sport Extra HD'' then Active_Subscriber_Report_Src.Active_Subscriber else 0 end as tinyint) as BT_Sports_Active,
cast(case when Active_Subscriber_Report_Src.subscription_sub_type = ''Sport Extra'' or Active_Subscriber_Report_Src.subscription_sub_type = ''Sport Extra HD'' then Active_Subscriber_Report_Src.Active_Subscription else 0 end as tinyint) as BT_Sports_Active_Subscription

from Decisioning.Active_Subscriber_Report_Src Active_Subscriber_Report_Src');